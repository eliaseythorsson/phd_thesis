# Results {#results}

```{r echo = FALSE, error = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE, error = FALSE, message = FALSE, warning = FALSE)
library(knitr)
library(tidyverse)
library(lubridate)
library(zoo)
load("_analyses/results/2018-11-25-04-1-results.RData")
```

## Data collection and sources {#datasourcesresults}

The results of papers I-VI are summarized in their respective sub-chapters. 
Because data was collected over a four year period from 2013-2017, and the papers that form this thesis were written and published at different times, the study period and population described in each paper varies slightly. 
They differ however only marginally from the final data summary described below. 

When data from all registries are taken together, individual level information was available for 375,383 Icelandic citizens, of which 183,544 were female and 181,316 were male.
Gender was unknown for 10,523 individuals. 
The full date of birth was known for 366,188 and birth-year was available for the rest.
The median birth-year for the whole study population was 1979 (IQR 1958-1997).
Death was registered for 12,308 individuals during the study period.

Several papers examined the data, stratified by birth-cohort.
The number of children in each birth-cohort who contributed data to the present study are shown in Table \@ref(tab:table-cohort-results).

```{r table-cohort-results}
kable(
    x = ids %>%
        filter(birth_y >= 2005, birth_y <= 2016) %>%
        group_by(birth_y) %>%
        summarise(
            n = n_distinct(id),
            prop_male = mean(as.numeric(factor(gender))-1, na.rm =T)*100) %>%
        left_join(
            ids %>%
                filter(birth_y >= 2005, birth_y <= 2016) %>%
                left_join(hs) %>%
                filter(!is.na(to_from)) %>%
                group_by(birth_y) %>%
                summarise(n_move = n_distinct(id))) %>%
        mutate(birth_y = as.character(birth_y),
               prop_male = signif(prop_male, 3)),
    col.names = c(
    "Birth-cohort",
    "No. children",
    "Proportion male (%)",
    "No. moved"
    ),
    caption = "Demographic information regarding birth-cohorts used in the study",
    format.args = list(big.mark = ",")
)
```


### Statistics Iceland

Statistics Iceland provided data on the immigration and emigration of all Icelandic children zero to four years of age from 2005-2017.
Of the 57,695 Icelandic children born 2005 or later, 5,577 moved to or from the country 6,847 times.
The proportion of children in each birth-cohort who moved at least once before five years of age, was consistently 9%-12% of those birth-cohorts who had full follow-up time (birth-cohorts 2005-2012).

### Landspitali University Hospital patient registry

All visits and hospitalizations with ICD-10 diagnostic codes compatible with respiratory infections (Table \@ref(tab:table-icd)) and procedural codes compatible with tympanostomy tube procedures (Table \@ref(tab:table-ncsp)), were extracted from Landspitali's patient registry. 
The number of visits and hospitalizations corresponding to each of the study's ICD-10 codes recorded in the first diagnostic field, are shown in Table \@ref(tab:table-icd10-results).

```{r table-icd10-results}
kable(
    x = data.frame(
    stringsAsFactors = FALSE,
    icd = c(
    "A40",
    "A41",
    "A48",
    "A49",
    "B00",
    "B08",
    "B33",
    "B34",
    "B95",
    "B96",
    "G00",
    "H65",
    "H66",
    "H70",
    "H72",
    "H73",
    "J00",
    "J01",
    "J02",
    "J03",
    "J04",
    "J05",
    "J06",
    "J09",
    "J10",
    "J11",
    "J12",
    "J13",
    "J14",
    "J15",
    "J16",
    "J17",
    "J18",
    "J20",
    "J21",
    "J22",
    "J32",
    "J36",
    "J40",
    "J85",
    "J86",
    "J90",
    "N30",
    "N39",
    "R05",
    "R50"
    ),
    Disease = c(
    "Streptococcal sepsis",
    "Other sepsis",
    "Other bacterial diseases, not elsewhere classified",
    "Bacterial infection of unspecified site",
    "Herpesviral [herpes simplex] infections",
    "Other viral infections characterized by skin and mucous membrane lesions, not elsewhere classified",
    "Other viral diseases, not elsewhere classified",
    "Viral infection of unspecified site",
    "Streptococcus, Staphylococcus, and Enterococcus as the cause of diseases classified elsewhere",
    "Other bacterial agents as the cause of diseases classified elsewhere",
    "Bacterial meningitis,not elsewhere classified",
    "Nonsuppurative otitis media",
    "Suppurative and unspecified otitis media",
    "Mastoiditis and related conditions",
    "Perforation of tympanic membrane",
    "Other disorders of tympanic membrane",
    "Acute nasopharyngitis [common cold]",
    "Acute sinusitis",
    "Acute pharyngitis",
    "Acute tonsillitis",
    "Acute laryngitis and tracheitis",
    "Acute obstructive laryngitis [croup] and epiglottitis",
    "Acute upper respiratory infections of multiple and unspecified sites",
    "Influenza due to certain identified influenza viruses",
    "Influenza due to other identified influenza virus",
    "Influenza due to unidentified influenza virus",
    "Viral pneumonia, not elsewhere classified",
    "Pneumonia due to Streptococcus pneumoniae",
    "Pneumonia due to Hemophilus influenzae",
    "Bacterial pneumonia, not elsewhere classified",
    "Pneumonia due to other infectious organisms, not elsewhere classified",
    "Pneumonia in diseases classified elsewhere",
    "Pneumonia, unspecified organism",
    "Acute bronchitis",
    "Acute bronchiolitis",
    "Unspecified acute lower respiratory infection",
    "Chronic sinusitis",
    "Peritonsillar abscess",
    "Bronchitis, not specified as acute or chronic",
    "Abscess of lung and mediastinum",
    "Pyothorax",
    "Pleural effusion, not elsewhere classified",
    "Cystitis",
    "Other disorders of urinary system",
    "Cough",
    "Fever of other and unknown origin"
    )
    ) %>%
    left_join(
    lsh %>%
    count(first_diagnosis, lotu_teg) %>%
    mutate(icd = str_extract(first_diagnosis, "^.{3}")) %>%
    group_by(icd, lotu_teg) %>%
    summarise(n = sum(n, na.rm = T)) %>%
    spread(lotu_teg, n)
    ) %>%
    left_join(
    hg %>%
    filter(staff_type == "LÃ¦") %>%
    count(main_diagnosis) %>%
    mutate(icd = str_extract(main_diagnosis, "^.{3}")) %>%
    group_by(icd) %>%
    summarise(n = sum(n, na.rm = T))
    ),
    col.names = c(
    "ICD-10 code",
    "Disease",
    "Hospital visits",
    "Hospitalizations",
    "Primary care visits"
    ),
    caption = "Number of visits or hospitalizations with International Classification of Diseases, 10th revision codes used in the current study as the primary diagnosis",
    format.args = list(big.mark = ",")
    )
```

A total of 169,585 records (of 74,740 individuals) were available, of which 135,841 (64,090) were visits to outpatient clinics or emergency departments and 33,744 (20,318) were hospital admissions.
The most visits of a single individual was 170 and the most admissions, 31. 
The number of procedures performed at Landspitali University Hospital is shown in Table \@ref(tab:table-ncsp-results).

```{r table-ncsp-results}
kable(
    x = data.frame(
    stringsAsFactors = FALSE,
    NCSP.code = c(
    "EMSB00",
    "EMSB10",
    "EMSB15",
    "EMSB20",
    "EMSB30",
    "EMSB99",
    "EMSW99",
    "DCSA10",
    "DCSA20",
    "DCSW00"
    ),
    Description = c(
    "Excision of lesion of tonsil or adenoid",
    "Tonsillectomy",
    "Intracapsular destruction of tonsils",
    "Adenotonsillectomy",
    "Adenotomy",
    "Other excision on tonsils and adenoids",
    "Other operation on tonsil or adenoids",
    "Paracentesis of tympanic membrane",
    "Insertion of ventilating tube through tympanic membrane",
    "Removal of ventilating tube from tympanic membrane"
    )
    ) %>%
    left_join(
    lsh %>%
    select(obs, id, ncsp) %>%
    separate(
    col = ncsp,
    into = as.character(1:5),
    extra = "drop",
    fill = "right",
    sep = " "
    ) %>%
    gather(procedure, code,-obs,-id) %>%
    filter(!is.na(code)) %>%
    mutate(NCSP.code =
    str_extract(
    string = str_remove(string =  code, pattern = "[:punct:]|[:space:]"),
    pattern = "^.{6}"
    )) %>%
    count(NCSP.code)
    ) %>%
    mutate(n = if_else(is.na(n), 0L, n)),
    col.names = c("NCSP code", "Description", "Number of procedures"),
    caption = "Number of study NOMESCO Classification of Surgical Procedures performed in the current study",
    format.args = list(big.mark = ",")
    )
```

The age distribution of visits and hospital admissions are shown in Figure \@ref(fig:density-age).
Though children and young adults comprise most of the visits due to study diagnoses, older adults make up the largest number of hospitalizations. 

```{r density-age, fig.cap = "Total number of contacts to Landspitali University Hospital and Primary Care Centers"}
include_graphics(path = "_figures/results/2018-11-16-density-age.png")
```

### The Primary Care Registry 

The Primary Care Registry recorded all primary care health contacts for the period 2005-2015.
All physician contacts associated with the diagnostic codes listed in Table \@ref(tab:table-icd) were extracted for that given period. 
A total of 1,963,439 separate contacts were recorded between 298,307 individual patients and 1,266 different physicians.
The most visits for a single individual was 212. 
The distribution of contacts by age can be seen in Figure \@ref(fig:density-age).

### The National Vaccine Registry

The National Vaccine Registry recorded all administered vaccine doses for the period 2005-2017.
All recorded pneumococcal vaccine doses were extracted.
A total of 110,712 doses of pneumococcal vaccines were administered to 51,601 individuals during the study period.
The monthly number of administered doses per age-group and vaccine is shown in Figure \@ref(fig:vaccine-time).

```{r vaccine-time, fig.cap = "Monthly number of administered pneumococcal vaccine doses by type and age-group"}
include_graphics(path = "_figures/results/2018-11-25-vaccine-time.png")
```

Table \@ref(tab:vaccine-doses) shows the number of children in each birth-cohort who had received zero, one, two, or three doses of a pneumococcal conjugate vaccine by four years of age. 
Children who moved to or from the country before four years of age, were excluded from the table. 

```{r vaccine-doses}
knitr::kable(
    x = ids %>%
    filter(birth_y >= 2005, birth_y <= 2016) %>%
    left_join(hs) %>%
    filter(is.na(to_from)) %>%
    left_join(bs %>%
    filter(
    !str_detect(code_text, "HafnaÃ°"),
    str_detect(atc, "J07AL02|J07AL52"),
    age_y <= 3
    )) %>%
    group_by(id) %>%
    mutate(
    dose = dense_rank(date_vacc),
    dose = case_when(is.na(dose) ~ 0,
    dose == 1 ~ 1,
    dose == 2 ~ 2,
    dose >= 3 ~ 3)
    ) %>%
    filter(dose == max(dose)) %>%
    ungroup() %>%
    count(birth_y, dose) %>%
    spread(key = dose, value = n) %>%
    mutate(birth_y = factor(birth_y)),
    col.names = c("Birth-cohort", "Zero doses", "One dose", "Two doses", "Three doses"),
    caption = "The number of children in each birth-cohort who has received from zero to three pneumococcal conjugate vaccine doses",
    format.args = list(big.mark = ",")
)
```

Some children in vaccine non-eligible cohorts received one, two or three doses of pneumococcal conjugate vaccines before four years of age. This generally occurred at an older age than children in the vaccine eligible cohorts Figure \@ref(fig:vaccine-age).

```{r vaccine-age, fig.cap = "Age at the time of administered pneumococcal vaccine dose by birth date"}
include_graphics(path = "_figures/results/2018-11-25-vaccine-age.png")
```

### The National Drug Prescription Registry

The National Drug Prescription Registry (NDPR) recorded all filled prescriptions from 2005-2017. 
From this registry, all antibacterials for systemic use (J01), vaccines (J07), opthalmologicals (S01) and otologicals (S02) were extracted. 
A total of 4,020,624 prescriptions were recorded among 360,560 individuals.
The number of prescriptions by therapeutic subgroup of the ATC classification system is shown in Table \@ref(tab:table-atc-results).
The highest number of antimicrobial prescriptions filled by a single individual was 336 during the study period. 

```{r table-atc-results}
kable(
    x = data.frame(
    stringsAsFactors = FALSE,
    ATC.code = c(
    "J01A",
    "J01B",
    "J01C",
    "J01D",
    "J01E",
    "J01F",
    "J01G",
    "J01M",
    "J01R",
    "J01X",
    "J07A",
    "J07B",
    "J07C",
    "J07X",
    "S01A",
    "S02A",
    "S01C",
    "S02C"
    ),
    Description = c(
    "Tetracyclines",
    "Amphenicols",
    "Beta-lactam antibacterials, penicillins",
    "Other beta-lactam antibacterials",
    "Sulfonamides and trimethoprim",
    "Macrolides, lincosamides and streptogramins",
    "Aminoglycoside antibacterials",
    "Quinolone antibacterials",
    "Combinations of antibacterials",
    "Other antibacterials",
    "Bacterial vaccines",
    "Viral vaccines",
    "Bacterial and viral vaccines",
    "Other vaccines",
    "Anti-infective opthalmologicals",
    "Anti-infective otologicals",
    "Anti-inflammatory agents and anti-infectives opthalmologicals",
    "Anti-inflammatory agents and anti-infectives otologicals"
    )
    ) %>% 
        left_join(
            lg %>%
                mutate(ATC.code = str_extract(atc, "^.{4}")) %>%
                count(ATC.code)
        ) %>%
        mutate(n = if_else(is.na(n), 0L, n))
        ,
    col.names = c("ATC chemical subgroup code", "Description", "No of prescriptions"),
    caption = "Number of prescriptions by Anatomical Therapeutic Chemical codes used in the current study",
    format.args = list(big.mark = ",")
    )
```

The distribution of antimicrobial prescriptions by age is shown in Figure \@ref(fig:prescriptions-age).


```{r prescriptions-age, fig.cap = "Antimicrobial prescriptions by age"}
include_graphics(path = "_figures/results/2018-11-18-prescriptions-age.png")
```

### Reimbursement database of Icelandic Health Insurance

All interactions with independent health care practitioners were recorded in Icelandic Health Insurance's reimbursement database. 
From this database, all records of otolaryngological procedures were extracted.
A total of 51,814 procedures were recorded among 34,084 individuals.
